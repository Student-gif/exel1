#unicode - 8
from fpdf import FPDF
from fpdf import FPDF_FONT_DIR

title = 'Расписание'

class PDF(FPDF):

    colontitle = None

    def header(self):
        """Оформление верхнего контитула каждого листа"""
        # Настройка шрифта: Sans, bold, размер 15 пунктов
        self.set_font("Sans", "", 15)
        # Вычисление ширины заголовка 
        # и установка положения курсора
        width = self.get_string_width(self.colontitle) + 6
        self.set_x((210 - width) / 2)
        # Настройка цветов для рамки, фона и текста
        self.set_draw_color(0, 80, 180)
        self.set_fill_color(230, 230, 0)
        self.set_text_color(220, 50, 50)
        # Настройка толщины рамки (1 mm)
        self.set_line_width(1)
        # вывод текста, переданного в `colontitle`
        self.cell(width, 9, self.colontitle, 1, 1, "C", True)
        # Выполнение разрыва строки в 10 мм
        self.ln(10)

    def footer(self):
        """Оформление нижнего контитула каждого листа"""
        # Устанавливаем курсор на 1,5 см от нижнего края
        self.set_y(-15)
        # Настройка шрифта: Sans, italic, 8
        self.set_font("Sans", "", 8)
        # Установка цвета текста на серый:
        self.set_text_color(128)
        # вывод номера страницы
        self.cell(0, 10, f"Page {self.page_no()}", 0, 0, "C")

    def chapter_title(self, num, label):
        """Оформление главы документа"""
        # Настройка шрифта: Sans 12
        self.set_font("Sans", "", 12)
        # Настройка цвета фона
        self.set_fill_color(200, 220, 255)
        # Печать названия главы
        self.cell(0, 6, f"Глава {num}: {label}", 0, 1, "L", True)
        # Выполнение разрыва строки на 4 мм
        self.ln(4)

    def chapter_body(self, filepath):
        """Чтение файла главы и вывод его в PDF-документ"""
        # Чтение текстового файла:
        with open(filepath, 'r') as fp:
            txt = fp.read()
        # Настройка шрифта: Times, размер 12 пунктов
        self.set_font("Times", size=12)
        # Печать текста:
        self.multi_cell(0, 5, txt)
        # Выполнение разрыва строки:
        self.ln()
        # надпись 'Конец главы' выделяем курсивом
        self.set_font(style="")
        self.cell(0, 5, "(Конец главы)")

    def print_chapter(self, num, title, filepath):
        """Печать одной главы документа"""
        self.add_page()
        self.chapter_title(num, title)
        self.chapter_body(filepath)


pdf = PDF()
# включаем TTF шрифты, поддерживающие кириллицу
pdf.add_font("Sans", style="", fname="font/DejaVuSans.ttf", uni=True)

# Добавляем метаданные только на английском
pdf.set_title("Document title")
pdf.set_author("Author of the document")
# текст верхнего колонтитула документа
pdf.colontitle = "Колонтитул документа"
# Вставляем текст по главам
pdf.output("test.pdf")
